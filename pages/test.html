<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Weighing System 2.0</title>
  </head>
  <body>
	<div id="menu"></div>
	<script src="../js/jquery/jquery.min.js"></script>
	<script type="text/javascript">
		var data = [
			{
				"text": "Weighing",
				"id": "1",
				"parentid": "0"
			}, {
				"id": "2",
				"parentid": "0",
				"text": "Truck In"
			}, {
				"id": "3",
				"parentid": "0",
				"text": "Edit Data"
			}, {
				"id": "4",
				"parentid": "3",
				"text": "Supplier Data"
			}, {
				"id": "5",
				"parentid": "3",
				"text": "Category Data"
			}
		];
			
		var builddata = function () {
			var source = [];
			var items = [];
			// build hierarchical source.
			for (i = 0; i < data.length; i++) {
				var item = data[i];
				var label = item["text"];
				var parentid = item["parentid"];
				var id = item["id"];

				if (items[parentid]) {
					var item = { parentid: parentid, label: label, item: item };
					if (!items[parentid].items) {
						items[parentid].items = [];
					}
					items[parentid].items[items[parentid].items.length] = item;
					items[id] = item;
				}
				else {
					items[id] = { parentid: parentid, label: label, item: item };
					source[id] = items[id];
				}
				console.log(source);
			}
			
			return source;
		}
		var source = builddata();

		var buildUL = function (parent, items) {
			$.each(items, function () {
				if (this.label) {
					// create LI element and append it to the parent element.
					var li = $("<li>" + this.label + "</li>");
					li.appendTo(parent);
					// if there are sub items, call the buildUL function.
					if (this.items && this.items.length > 0) {
						var ul = $("<ul></ul>");
						ul.appendTo(li);
						buildUL(ul, this.items);
					}
				}
			});
		}
		
		var ul = $("<ul></ul>");
		ul.appendTo("#menu");
		buildUL(ul, source);
	</script>
	</body>
</html>