<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap>
	
	<update id="addDocketPrintLogSql" parameterClass="java.util.Map">
		INSERT INTO `docket_print_log` (docket_no, user_name)
			VALUES (#docket_no#, #user_name#)
	</update>

	<update id="updateDocketPrintLogSql" parameterClass="java.util.Map">
		UPDATE `docket_print_log` SET
			 docket_no = #docket_no#
			,user_name = #user_name#
		  WHERE dp_id = #dp_id#
	</update>

	<select id="getAllDocketPrintLogSql" parameterClass="java.util.Map" resultClass="java.util.HashMap" remapResults="false">
		SELECT 
			LPAD(`docket_no`, 6, 0) AS docket_no, 
			`user_name`, 
			FORMAT(COUNT(`docket_no`), 0) AS reprint_count, 
			DATE_FORMAT(`date_modified`, '%m/%d/%Y') AS reprint_date
		FROM `docket_print_log`
		WHERE 1 = 1
		<dynamic>
			<isNotEmpty property="startDate" prepend="AND">
				DATE_FORMAT(`date_modified`, '%m/%d/%Y') 
				BETWEEN #startDate# AND #endDate#
			</isNotEmpty>
			<isNotEmpty property="docket_no" prepend="AND">
				`docket_no` = #docket_no#
			</isNotEmpty>
		</dynamic>
		GROUP BY DATE_FORMAT(`date_modified`, '%m/%d/%Y'), `docket_no`, `user_name`
		ORDER BY DATE_FORMAT(`date_modified`, '%m/%d/%Y') ASC
	</select>
	
</sqlMap>
	