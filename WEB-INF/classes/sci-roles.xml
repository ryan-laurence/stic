<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap>
	
	<update id="addRolesSql" parameterClass="java.util.Map">
		INSERT INTO `roles` (role_name)
			VALUES (#role_name#)
	</update>

	<update id="updateRolesSql" parameterClass="java.util.Map">
		UPDATE `roles` SET
			 role_name = #role_name#
		  WHERE role_id = #role_id#
	</update>

	<update id="updateRolesByIsDeletedSql" parameterClass="java.util.Map">
		UPDATE `roles` SET
			 status = #status#
		  WHERE role_id = #role_id#
	</update>
	
	<select id="getAllRolesSql" parameterClass="java.util.Map" resultClass="java.util.HashMap" remapResults="false">
		SELECT 
			role_id, 
			role_name, 
			`status`, 
			DATE_FORMAT(`date_modified`, '%m/%d/%Y %r') AS date_modified 
		FROM `roles` 
		WHERE `status` = 1
			AND role_name != 'Super User'
			<dynamic>
			  	<isNotEmpty property="role_id" prepend="AND">
			  		role_id > #role_id#
			  	</isNotEmpty>
			</dynamic>
		ORDER BY role_name
	</select>
	
	<select id="getAllRolesByRoleNameSql" parameterClass="java.util.Map" resultClass="java.util.HashMap" remapResults="false">
		SELECT * FROM `roles`
			WHERE `role_name` = #role_name# 
				AND `status` = 1
			<dynamic>
			  	<isNotEmpty property="role_id" prepend="AND">
			  		role_id != #role_id#
			  	</isNotEmpty>
			</dynamic>
	</select>

</sqlMap>
	